{# empty Twig template #}

{% extends 'SonataAdminBundle:CRUD:base_edit.html.twig' %}

{% set _messageCurrentTemplate = action is defined and action == 'edit' ?
                        '<i class="fa fa-refresh"></i> <i class="fa fa-pencil-square-o"></i> Edici√≥n de registro' :
                        '<i class="fa fa-floppy-o"></i> <span class="glyphicon glyphicon-plus-sign"></span> Nuevo registro' %}

{% block stylesheets %}
    {{ parent() }}
    
    {# Bootstrap #}
    {#<link href="{{ asset('bundles/sanrafaelrequerimientos/plugin/bootstrap-3.3.7-dist/css/bootstrap.min.css') }}" type="text/css" rel="stylesheet" />
    <link href="{{ asset('bundles/sanrafaelrequerimientos/plugin/bootstrap-3.3.7-dist/css/bootstrap-theme.min.css') }}" type="text/css" rel="stylesheet" />#}
    
    {# sigereq-styles #}
    <link href="{{ asset('bundles/sanrafaelrequerimientos/css/sigereq-styles.css') }}" type="text/css" rel="stylesheet" />
    <link href="{{ asset('bundles/sanrafaelrequerimientos/css/sigereq-form-styles.css') }}" type="text/css" rel="stylesheet" />
    <link href="{{ asset('bundles/sanrafaelrequerimientos/css/sigereq-extend-bootstrap3.css') }}" type="text/css" rel="stylesheet" />
    <link href="{{ asset('bundles/sanrafaelrequerimientos/css/sigereq-table.css') }}" type="text/css" rel="stylesheet" />
    
    {# jquery-ui #}
    <link href="{{ asset('bundles/sanrafaelrequerimientos/plugin/jquery-ui-1.12.0.custom/jquery-ui.theme.min.css') }}" type="text/css" rel="stylesheet" />
    
    {# Bootstrap-calendar #}
    <link href="{{ asset('bundles/sanrafaelrequerimientos/plugin/bootstrap-datetimepicker-development/build/css/bootstrap-datetimepicker.min.css') }}" type="text/css" rel="stylesheet" />
    
    {# iCheck #}
    <link href="{{ asset('bundles/sanrafaelrequerimientos/plugin/icheck-1.x/skins/minimal/aero.css') }}" type="text/css" rel="stylesheet" />
    
    {# Twitter Typeahead #}
    <link href="{{ asset('bundles/sanrafaelrequerimientos/css/typeahead.css') }}" type="text/css" rel="stylesheet" />
    
    {# bootstrap-table #}
    <link href="{{ asset('bundles/sanrafaelrequerimientos/plugin/bootstrap-table-master/dist/bootstrap-table.min.css') }}" type="text/css" rel="stylesheet" media="screen" />
    
    {# formValidation #}
    <link href="{{ asset('bundles/sanrafaelrequerimientos/plugin/formvalidation-master/dist/css/formValidation.min.css') }}" type="text/css" rel="stylesheet" />
    
    {# toastmessage #}
    <link href="{{ asset('bundles/sanrafaelrequerimientos/plugin/akquinet-jquery-toastmessage-plugin-6f5d7bf/src/main/resources/css/jquery.toastmessage.css') }}" type="text/css" rel="stylesheet" />
    
    {# bootstrap-modal #}
    <link href="{{ asset('bundles/sanrafaelrequerimientos/plugin/bootstrap-modal-master/css/bootstrap-modal-bs3patch.css') }}" type="text/css" rel="stylesheet" />
    <link href="{{ asset('bundles/sanrafaelrequerimientos/plugin/bootstrap-modal-master/css/bootstrap-modal.css') }}" type="text/css" rel="stylesheet" />
    
    {# bootstrap-vertical-tabs #}
    <link href="{{ asset('bundles/sanrafaelrequerimientos/plugin/bootstrap-vertical-tabs-1.2.1/bootstrap.vertical-tabs.css') }}" type="text/css" rel="stylesheet" />
    
    {# bootstrap-switch #}
    <link href="{{ asset('bundles/sanrafaelrequerimientos/plugin/bootstrap-switch-master/dist/css/bootstrap3/bootstrap-switch.min.css') }}" type="text/css" rel="stylesheet" />
    
    {# select2-bootstrap #}
    <link href="{{ asset('bundles/sanrafaelrequerimientos/css/select2-bootstrap.css') }}" type="text/css" rel="stylesheet" />
{% endblock %}
    
{% block javascripts %}
    {{ parent() }}
    <script>
	window.GLOBAL_ADMIN_CONFIG = {
	    ADMIN_UNIQID_TOKEN: '{{ admin.uniqId }}',
	    CURRENT_ACTION_FORM: {% if action is defined %}{{ action }}{% else %}'create'{% endif %},
	    OBJECT_ID: {% if admin.id(object) is not null %}{{ object.id }}{% else %}false{% endif %},
	    IS_OBJECT_ALLOW_TO_SWITCH: false,
	    ID_USERLOGGED: {{ app.user.getId()|escape('js') }},
	    ID_USERLOGGED_EMPLOYEE: {% if app.user.getIdEmpleado() is not null %}{{ app.user.getIdEmpleado().getId()|escape('js') }}{% else %}false{% endif %},
	    COD_USERLOGGED_EMPLOYEE: {% if app.user.getIdEmpleado() is not null %}'{{ app.user.getIdEmpleado().getIdTipoEmpleado().getCodigo()|escape('js') }}'{% else %}false{% endif %},
	    ID_USERLOGGED_ESTAB: {% if app.user.getIdEstablecimiento() is not null %}{{ app.user.getIdEstablecimiento().getId()|escape('js') }}{% else %}false{% endif %}
	};
	window.GLOBAL_BUNDLE_CONFIG = {
	    IS_USERLOGGED_ADMIN: {% if is_granted('ROLE_ADMIN') %}true{% else %}false{% endif %},
	    IS_USERLOGGED_RADX: {% if is_granted('ROLE_MINSAL_SIMAGD_ADMIN_IMG_LECTURA_CREATE') and (app.user.getIdEmpleado() is not null and app.user.getIdEmpleado().getIdTipoEmpleado().getCodigo() == 'MRY') %}true{% else %}false{% endif %},
	    IS_USERLOGGED_PRCMED: {% if is_granted('ROLE_MINSAL_SIMAGD_ADMIN_IMG_SOLICITUD_ESTUDIO_CREATE') and (app.user.getIdEmpleado() is not null and app.user.getIdEmpleado().getIdTipoEmpleado().getCodigo() == 'MED') %}true{% else %}false{% endif %}
	};
	window.console.log(jQuery.extend(true, {}, window.GLOBAL_ADMIN_CONFIG, window.GLOBAL_BUNDLE_CONFIG));
    </script>
    
    {# Bootstrap #}
    {#<script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/plugin/bootstrap-3.3.7-dist/js/bootstrap.min.js') }}" ></script>#}

    {# select2-es #}
    <script type="text/javascript" src="{{ asset('/bundles/sonataadmin/vendor/select2/select2_locale_es.js') }}" ></script>
    
    {# iCheck #}
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/plugin/icheck-1.x/icheck.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/js/sigereq_form_configuration.js') }}" ></script>
    
    {# jquery-ui #}
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/plugin/jquery-ui-1.12.0.custom/jquery-ui.min.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/js/sigereq_highlight_error_ui.js') }}" ></script>

    {# jquery-formparams #}
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/js/jquery.formparams.min.js') }}" ></script>

    {# jquery-maskedinput #}
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/js/jquery.mask.min.js') }}" ></script>
    
    {# Simagd extend jQuery #}
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/js/sigereq_jQueryCustomFunctions.js') }}" ></script>
    
    {# Twitter Typeahead #}
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/plugin/typeahead.js-master/dist/typeahead.bundle.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/plugin/typeahead.js-master/dist/bloodhound.js') }}" ></script>
    
    {# bootstrap-table #}
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/plugin/bootstrap-table-master/dist/bootstrap-table.min.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/plugin/bootstrap-table-master/dist/locale/bootstrap-table-es-CR.min.js') }}" ></script>
    {# data format for bootstrap-table #}
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/js/sigereq_data_bsTable_formatter.js') }}" ></script>
    {# filters for bootstrap-table #}
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/js/sigereq_filter_bstable_configuration.js') }}" ></script>
    
    {# Bootstrap-calendar #}
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/plugin/moment-develop/min/moment-with-locales.min.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/plugin/bootstrap-datetimepicker-development/build/js/bootstrap-datetimepicker.min.js') }}" ></script>
    
    {# Simagd Custom Scripts #}
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/js/sigereq_personal_formplugin.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/js/sigereq_init_formplugin.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/js/sigereq_form_configuration_v2.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/js/sigereq_configuration_alert.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/js/sigereq_setterObject_modalData.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/js/sigereq_select2_custom_formatter.js') }}" ></script>
    
    {# Patologia Custom Scripts #}
    <script type="text/javascript" src="{{ asset('bundles/minsalpatologia/js/patlg_edittemplate_bsform_configuration.js') }}" ></script>
    
    {# formValidation #}
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/plugin/formvalidation-master/dist/js/formValidation.min.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/plugin/formvalidation-master/dist/js/framework/bootstrap.min.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/plugin/formvalidation-master/dist/js/language/es_ES.js') }}" ></script>
    
    {# toastmessage #}
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/plugin/akquinet-jquery-toastmessage-plugin-6f5d7bf/src/main/javascript/jquery.toastmessage.js') }}" ></script>
    
    {# bootstrap-modal #}
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/plugin/bootstrap-modal-master/js/bootstrap-modalmanager.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/plugin/bootstrap-modal-master/js/bootstrap-modal.js') }}" ></script>
    
    {# bootstrap-switch #}
    <script type="text/javascript" src="{{ asset('bundles/sanrafaelrequerimientos/plugin/bootstrap-switch-master/dist/js/bootstrap-switch.min.js') }}" ></script>
{% endblock %}

{% block sonata_page_content_header %}
    {% block sonata_page_content_nav %}
        {% if _tab_menu is not empty or _actions is not empty %}
            <nav class="navbar navbar-default" role="navigation">
                <div class="container-fluid">
                    <!-- Brand and toggle get grouped for better mobile display -->
                    {% block tab_menu_navbar_header %}
                        <div class="navbar-header">
                            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                                <span class="sr-only">Toggle navigation</span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                            </button>
                            {% block sigereq_form_navbar_brand_title %}
                                <span class="navbar-brand">
                                    <span class="label label-{{ action is defined and action == 'edit' ? 'primary-v4' : 'success-v3' }}"> {{ _messageCurrentTemplate|truncate(150)|raw }} </span>
                                </span>
                            {% endblock %}
                        </div>
                    {% endblock %}

                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                        <ul class="nav navbar-nav">
                            {% block sigereq_navbar_left_nav %}
                                {# add custom items #}
                                <div style="{#padding-top: 8px;#}">
                                    <input type="checkbox" name="switch_for_form_and_register" data-apply-bootstrap-switch="true" checked data-on-text="{#<span class='glyphicon glyphicon-edit' aria-hidden='true'></span>#} Formulario" data-off-text="{#<span class='glyphicon glyphicon-folder-open' aria-hidden='true'></span>#} Registros" data-label-text="Vista" data-inverse="true" class="chk-bsswitch-container form-control input-sm" data-size="small" />
                                </div>
                                {% if _tab_menu is not empty %}
                                    {{ _tab_menu|raw }}
                                {% endif %}
                            {% endblock %}
                        </ul>
                        {% block sigereq_navbar_middle_nav %}
                            {# add custom items, you can add a form #}
                        {% endblock %}
                        <ul class="nav navbar-nav">
                            {% if _actions|replace({ '<li>': '', '</li>': '' })|trim is not empty %}
                                {{ _actions|replace({ '\r': '', '\n': '' })|replace({ '<li></li>': '' })|raw }}
                            {% endif %}
                            {% block sigereq_navbar_middle_after_list_nav %}
                            {% endblock %}
                        </ul>
			{% block sigereq_navbar_middle_after_nav %}
			{% endblock %}
                        <ul class="nav navbar-nav navbar-right">
                            {% block sigereq_navbar_right_nav %}
                            {% endblock %}
                        </ul>
                    </div><!-- /.navbar-collapse -->
                </div><!-- /.container-fluid -->
            </nav>
        {% endif %}
    {% endblock sonata_page_content_nav %}

{% endblock sonata_page_content_header %}
    
{% block content %}
    
    {% block notice %}
        {% include 'SanRafaelRequerimientosBundle::sigereq_flash_notice.html.twig' %}
    {% endblock notice %}
    
    {{ parent() }}
    
{% endblock %}

{% block form %}
    {{ sonata_block_render_event('sonata.admin.edit.form.top', { 'admin': admin, 'object': object }) }}

    {% set url = admin.id(object) is not null ? 'edit' : 'create' %}

    {% if not admin.hasRoute(url)%}
        <div>
            {{ "form_not_available"|trans({}, "SonataAdminBundle") }}
        </div>
    {% else %}
        <form
              class="form-horizontal"
              role="form"
              action="{{ admin.generateUrl(url, {'id': admin.id(object), 'uniqid': admin.uniqid, 'subclass': app.request.get('subclass')}) }}" {{ form_enctype(form) }}
              method="POST"
              novalidate="novalidate"
	      data-clientside-validation="page"
	      {% block sigereq_apply_custom_formid %}
		  {# can add a custom id to the form #}
		  id="sigereq_entity_full_admin_form"
	      {% endblock %}
	      {% block sigereq_apply_custom_formname %}
		  {# can add a name to the form #}
	      {% endblock %}
              >
            {% if form.vars.errors|length > 0 %}
                <div class="sonata-ba-form-error">
                    {{ form_errors(form) }}
                </div>
            {% endif %}

            {% block sonata_pre_fieldsets %}
                <div class="row">
            {% endblock %}

            {% block sonata_tab_content %}
                {% for name, form_group in admin.formgroups %}
                    <div class="{{ form_group.class|default('col-md-12') }}">
                        <div class="box box-drop-outside-shadow box-primary-v4">
                            <div class="box-header">
                                <h4 class="box-title">
                                    <span class="label label-primary-v4">{{ admin.trans(name, {}, form_group.translation_domain) }}</span>
                                </h4>
                            </div>
                            {#<div class="box{% if loop.first %} in{% endif %}" id="{{ admin.uniqid }}_{{ loop.index }}">#}
                                <div class="box-body">
                                    <div class="sonata-ba-collapsed-fields">
                                        {% if form_group.description != false %}
                                            <p>{{ form_group.description|raw }}</p>
                                        {% endif %}

                                        {% for field_name in form_group.fields %}
                                            {% if admin.formfielddescriptions[field_name] is defined %}
                                                {{ form_row(form[field_name])}}
                                            {% endif %}
                                        {% endfor %}
                                    </div>
                                </div>
                            {#</div>#}
                        </div>
                    </div>
                {% endfor %}
            {% endblock %}

            {% block sonata_post_fieldsets %}
                </div>
            {% endblock %}

            {{ form_rest(form) }}

            {% block formactions %}
                <div class="well well-small form-actions left-side-actions">
                    {% if app.request.isxmlhttprequest %}
                        {% if admin.id(object) is not null %}
			    <button type="button" data-dismiss="modal" class="btn btn-primary-v4"><i class="fa fa-times"></i> No, Cerrar</button>
                            <button type="submit" class="btn btn-primary-v4" name="btn_update"><span class="glyphicon glyphicon-floppy-saved"></span> Editar</button>
                        {% else %}
			    <button type="button" data-dismiss="modal" class="btn btn-primary-v4"><i class="fa fa-times"></i> No, Cerrar</button>
                            <button type="submit" class="btn btn-success-v3" name="btn_create"><span class="glyphicon glyphicon-plus-sign"></span> Enviar</button>
                        {% endif %}
                    {% else %}
                        {% if admin.supportsPreviewMode %}
                            <button class="btn btn-info persist-preview" name="btn_preview" type="submit">
                                <i class="fa fa-eye"></i>
                                {{ 'btn_preview'|trans({}, 'SonataAdminBundle') }}
                            </button>
                        {% endif %}
                        {% if admin.id(object) is not null %}
                            <button type="submit" class="btn btn-primary-v4" name="btn_update_and_edit"><span class="glyphicon glyphicon-floppy-saved"></span> Enviar</button>

                            {% if admin.hasroute('list') and admin.isGranted('LIST') %}
                                <button type="submit" class="btn btn-primary-v4" name="btn_update_and_list"><span class="glyphicon glyphicon-floppy-disk"></span> <span class="glyphicon glyphicon-list"></span> Enviar</button>
                            {% endif %}{# #}

                            {% if admin.hasroute('delete') and admin.isGranted('DELETE', object) %}
                                {{ 'delete_or'|trans({}, 'SonataAdminBundle') }}
                                <a class="btn btn-danger" href="{{ admin.generateObjectUrl('delete', object) }}"><span class="glyphicon glyphicon-trash"></span> {{ 'link_delete'|trans({}, 'SonataAdminBundle') }}</a>
                            {% endif %}

                            {% if admin.isAclEnabled() and admin.hasroute('acl') and admin.isGranted('MASTER', object) %}
                                <a class="btn btn-info" href="{{ admin.generateObjectUrl('acl', object) }}"><i class="fa fa-users"></i> {{ 'link_edit_acl'|trans({}, 'SonataAdminBundle') }}</a>
                            {% endif %}
			    <button class="btn btn-default" type="reset" name="btn_reset_on_edit"><i class="fa fa-repeat"></i> Restablecer</button>
                        {% else %}
                            {% if admin.hasroute('edit') and admin.isGranted('EDIT') %}
                                <button class="btn btn-success-v3" type="submit" name="btn_create_and_edit"><span class="glyphicon glyphicon-floppy-saved"></span> Enviar</button>
                            {% endif %}
                            {% if admin.hasroute('list') and admin.isGranted('LIST') %}
                                <button type="submit" class="btn btn-success-v3" name="btn_create_and_list"><span class="glyphicon glyphicon-floppy-disk"></span> <span class="glyphicon glyphicon-list"></span> Enviar</button>
                            {% endif %}{# #}
                            <button class="btn btn-success-v3" type="submit" name="btn_create_and_create"><span class="glyphicon glyphicon-floppy-saved"></span> <span class="glyphicon glyphicon-repeat"></span> Enviar</button>{# #}
			    <button class="btn btn-default" type="reset" name="btn_reset_on_create"><i class="fa fa-repeat"></i> Restablecer</button>
                        {% endif %}
                    {% endif %}
                </div>
            {% endblock formactions %}
        </form>
    {% endif%}

    {{ sonata_block_render_event('sonata.admin.edit.form.bottom', { 'admin': admin, 'object': object }) }}

{% endblock %}