{#

This file is part of the Sonata package.

(c) Thomas Rabaix <thomas.rabaix@sonata-project.org>

For the full copyright and license information, please view the LICENSE
file that was distributed with this source code.

#}

{#{% extends base_template %}#}
{% extends 'MinsalSiblhBundle:CRUD:base_edit.html.twig' %}

{% block stylesheets %}
    {{ parent() }}

    {# bootstrap-table #}
    <link href="{{ asset('bundles/minsalsiblh/plugin/bootstrap-table-master/dist/bootstrap-table.min.css') }}" type="text/css" rel="stylesheet" media="screen" />
    
    {# bootstrap-modal
    <link href="{{ asset('bundles/minsalsiblh/plugin/bootstrap-modal-master/css/bootstrap-modal-bs3patch.css') }}" type="text/css" rel="stylesheet" />
    <link href="{{ asset('bundles/minsalsiblh/plugin/bootstrap-modal-master/css/bootstrap-modal.css') }}" type="text/css" rel="stylesheet" /> #}

    {# bootstrap sweetalert #}
    <link href="{{ asset('bundles/minsalsiblh/plugin/bootstrap-sweetalert-master/dist/sweetalert.css') }}" type="text/css" rel="stylesheet" />
    <link href="{{ asset('bundles/minsalsiblh/css/sweetalert.css') }}" type="text/css" rel="stylesheet" />
{% endblock %}

{% use 'MinsalSiblhBundle:BlhAnalisisSensorialAdmin:base_edit_form.html.twig' with form as parentForm %}

{% block form %}

    {{ block('parentForm') }}

{% endblock %}

{% block javascripts %}
    {{ parent() }}

    {# bootstrap-table #}
    <script type="text/javascript" src="{{ asset('bundles/minsalsiblh/plugin/bootstrap-table-master/dist/bootstrap-table.min.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/minsalsiblh/plugin/bootstrap-table-master/dist/locale/bootstrap-table-es-CR.min.js') }}" ></script>
    
    {# bootstrap-modal
    <script type="text/javascript" src="{{ asset('bundles/minsalsiblh/plugin/bootstrap-modal-master/js/bootstrap-modalmanager.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/minsalsiblh/plugin/bootstrap-modal-master/js/bootstrap-modal.js') }}" ></script> #}

    {# bootstrap sweetalert #}
    <script type="text/javascript" src="{{ asset('bundles/minsalsiblh/plugin/bootstrap-sweetalert-master/dist/sweetalert.min.js') }}" ></script>

    <script type="text/javascript">

        jQuery(document).ready(function() {
            ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
            //////// enable selections
            //////// >>>> assuming [1] as APPROVED STATUS
            ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
            jQuery('#{{ admin.uniqId }}_idResultadoEmbalaje').on('change', function (e) {
                // console.log(this.value, parseInt(this.value), parseInt(this.value) === 1);
                if (parseInt(this.value) === 1) {
                    jQuery('#{{ admin.uniqId }}_idResultadoSuciedad'){% if admin.id(object) is null %}.select2('val', {{ form.idResultadoSuciedad.vars.value }}){% endif %}.select2('enable', parseInt(this.value) === 1);
                    jQuery(this).closest('form').formValidation('addField', '{{ admin.uniqId }}[idResultadoSuciedad]');
                }
                else {
                    jQuery(this).closest('form')
                        .formValidation('resetField', '{{ admin.uniqId }}[idResultadoSuciedad]')
                        .formValidation('removeField', '{{ admin.uniqId }}[idResultadoSuciedad]')
                        .formValidation('resetField', '{{ admin.uniqId }}[idResultadoColor]')
                        .formValidation('removeField', '{{ admin.uniqId }}[idResultadoColor]')
                        .formValidation('resetField', '{{ admin.uniqId }}[idResultadoFlavor]')
                        .formValidation('removeField', '{{ admin.uniqId }}[idResultadoFlavor]');
                    jQuery('#{{ admin.uniqId }}_idResultadoSuciedad'){% if admin.id(object) is null %}.select2('val', {{ form.idResultadoSuciedad.vars.value }}){% endif %}.select2('enable', parseInt(this.value) === 1);
                    jQuery('#{{ admin.uniqId }}_idResultadoColor'){% if admin.id(object) is null %}.select2('val', 4){% endif %}.select2('enable', parseInt(this.value) === 1);
                    jQuery('#{{ admin.uniqId }}_idResultadoFlavor'){% if admin.id(object) is null %}.select2('val', 4){% endif %}.select2('enable', parseInt(this.value) === 1);
                }
            });
            jQuery('#{{ admin.uniqId }}_idResultadoSuciedad').on('change', function (e) {
                jQuery('#HIDDEN_{{ admin.uniqId }}_idResultadoSuciedad').val(this.value);
                // console.log(this.value, parseInt(this.value), parseInt(this.value) === 1);
                if (parseInt(this.value) === 1) {
                    jQuery('#{{ admin.uniqId }}_idResultadoColor'){% if admin.id(object) is null %}.select2('val', 4){% endif %}.select2('enable', parseInt(this.value) === 1);
                    jQuery(this).closest('form').formValidation('addField', '{{ admin.uniqId }}[idResultadoColor]');
                }
                else {
                    jQuery(this).closest('form')
                        .formValidation('resetField', '{{ admin.uniqId }}[idResultadoColor]')
                        .formValidation('removeField', '{{ admin.uniqId }}[idResultadoColor]')
                        .formValidation('resetField', '{{ admin.uniqId }}[idResultadoFlavor]')
                        .formValidation('removeField', '{{ admin.uniqId }}[idResultadoFlavor]');
                    jQuery('#{{ admin.uniqId }}_idResultadoColor'){% if admin.id(object) is null %}.select2('val', 4){% endif %}.select2('enable', parseInt(this.value) === 1);
                    jQuery('#{{ admin.uniqId }}_idResultadoFlavor'){% if admin.id(object) is null %}.select2('val', 4){% endif %}.select2('enable', parseInt(this.value) === 1);
                }
            });
            jQuery('#{{ admin.uniqId }}_idResultadoColor').on('change', function (e) {
                jQuery('#HIDDEN_{{ admin.uniqId }}_idResultadoColor').val(this.value);
                // console.log(this.value, parseInt(this.value), parseInt(this.value) === 1);
                if (parseInt(this.value) === 1) {
                    jQuery('#{{ admin.uniqId }}_idResultadoFlavor'){% if admin.id(object) is null %}.select2('val', 4){% endif %}.select2('enable', parseInt(this.value) === 1);
                    jQuery(this).closest('form').formValidation('addField', '{{ admin.uniqId }}[idResultadoFlavor]');
                }
                else {
                    jQuery(this).closest('form')
                        .formValidation('resetField', '{{ admin.uniqId }}[idResultadoFlavor]')
                        .formValidation('removeField', '{{ admin.uniqId }}[idResultadoFlavor]');
                    jQuery('#{{ admin.uniqId }}_idResultadoFlavor'){% if admin.id(object) is null %}.select2('val', 4){% endif %}.select2('enable', parseInt(this.value) === 1);
                }
            });
            jQuery('#{{ admin.uniqId }}_idResultadoFlavor').on('change', function (e) {
                jQuery('#HIDDEN_{{ admin.uniqId }}_idResultadoFlavor').val(this.value);
            });

            //////// init select2 disabled mode
            {#jQuery('#{{ admin.uniqId }}_idResultadoEmbalaje').triggerHandler('change');#}
            {#jQuery('#{{ admin.uniqId }}_idResultadoSuciedad').triggerHandler('change');#}
            {#jQuery('#{{ admin.uniqId }}_idResultadoColor').triggerHandler('change');#}
            window.alert('Se necesita que se haga triggerHandler de change.\nSe necesita que .select2(\'val\', 4) no sea 4, sino su valor value="{ form[field_name].vars.value }');
            ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        });

    </script>
{% endblock %}